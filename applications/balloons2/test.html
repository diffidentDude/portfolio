<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>
        <script type="module">
            import { collisionLoop, collisionLoop2, collisionLoop3, collisionLoop4, vectorFn, hypotenuse, minus, objectCollisions, cirleOverlaps } from './stuff.js'

            function ballPairs(balls) {
                return balls.reduce((accumulator, nextBall, index1) => {
                    balls.forEach((_, index2) => {
                        if (index1 !== index2 && !accumulator.find((ballPair) => {
                            const contains1 = ballPair.includes(index1);
                            const contains2 = ballPair.includes(index2);
                            return contains1 && contains2;
                        })) {
                            accumulator.push([index1, index2]);
                        }
                    });
                    return accumulator;
                }, []);
            }

            const testJSON = `[{"position":{"x":47.03756887670855,"y":650.9960320356251},"velocity":{"x":0.01878429143009592,"y":0.622962625812146},"mass":{"x":4.7,"y":4.7},"radius":{"x":47,"y":47},"A":0.6939778171779853,"accelaration":{"x":0,"y":0},"colour":"rgba(53, 79, 158, 1)","id":"15-15"},{"position":{"x":128.3529620006635,"y":799.7389530643098},"velocity":{"x":-0.1738248639116495,"y":0.7046765161776413},"mass":{"x":4.4,"y":4.4},"radius":{"x":44,"y":44},"A":0.6082123377349838,"accelaration":{"x":0,"y":0},"colour":"rgba(9, 134, 103, 1)","id":"15-165"},{"position":{"x":44.13670762277463,"y":785.3320429701836},"velocity":{"x":0.06835199010559476,"y":0.22150343576298856},"mass":{"x":4.4,"y":4.4},"radius":{"x":44,"y":44},"A":0.6082123377349838,"accelaration":{"x":0,"y":0},"colour":"rgba(214, 242, 150, 1)","id":"15-315"},{"position":{"x":97.50433974486026,"y":721.3894562806219},"velocity":{"x":0.42365264718365453,"y":0.35781517407149943},"mass":{"x":4,"y":4},"radius":{"x":40,"y":40},"A":0.5026548245743669,"accelaration":{"x":0,"y":0},"colour":"rgba(51, 155, 134, 1)","id":"15-465"},{"position":{"x":152.82907111894426,"y":873.1160559723947},"velocity":{"x":-0.08546664066021639,"y":0.5544657823208026},"mass":{"x":3.4000000000000004,"y":3.4000000000000004},"radius":{"x":34,"y":34},"A":0.3631681107549801,"accelaration":{"x":0,"y":0},"colour":"rgba(111, 89, 164, 1)","id":"15-615"},{"position":{"x":115.95763804951453,"y":857.4009069677746},"velocity":{"x":0.5218828586036557,"y":0.6685489635367218},"mass":{"x":0.8,"y":0.8},"radius":{"x":8,"y":8},"A":0.020106192982974676,"accelaration":{"x":0,"y":0},"colour":"rgba(213, 131, 194, 1)","id":"15-765"},{"position":{"x":50.01352393368364,"y":878.6476539883053},"velocity":{"x":0.0067619465876216905,"y":-0.07808675410664805},"mass":{"x":5,"y":5},"radius":{"x":50,"y":50},"A":0.7853981633974483,"accelaration":{"x":0,"y":0},"colour":"rgba(51, 112, 152, 1)","id":"15-915"},{"position":{"x":159.66662111630885,"y":736.9330705000195},"velocity":{"x":-0.16669608813010786,"y":0.6191054922463565},"mass":{"x":2.7,"y":2.7},"radius":{"x":27,"y":27},"A":0.2290221044466959,"accelaration":{"x":0,"y":0},"colour":"rgba(139, 195, 50, 1)","id":"165-15"},{"position":{"x":102.7202096044515,"y":876.8092817797801},"velocity":{"x":0.4637396255865443,"y":0.6737995927347656},"mass":{"x":0.30000000000000004,"y":0.30000000000000004},"radius":{"x":3,"y":3},"A":0.0028274333882308137,"accelaration":{"x":0,"y":0},"colour":"rgba(134, 234, 243, 1)","id":"165-165"},{"position":{"x":105.07828651370481,"y":885.9795909081455},"velocity":{"x":0.06127376388699965,"y":0.5125053254791897},"mass":{"x":0.7000000000000001,"y":0.7000000000000001},"radius":{"x":7,"y":7},"A":0.015393804002589986,"accelaration":{"x":0,"y":0},"colour":"rgba(31, 161, 179, 1)","id":"165-315"},{"position":{"x":112.98835902648344,"y":908.5675053900976},"velocity":{"x":-0.3463472794448428,"y":-0.11815559067371813},"mass":{"x":2,"y":2},"radius":{"x":20,"y":20},"A":0.12566370614359174,"accelaration":{"x":0,"y":0},"colour":"rgba(53, 30, 60, 1)","id":"165-465"},{"position":{"x":113.20209577159812,"y":873.3418156063036},"velocity":{"x":0.4563522784566786,"y":0.7420927272292854},"mass":{"x":0.8,"y":0.8},"radius":{"x":8,"y":8},"A":0.020106192982974676,"accelaration":{"x":0,"y":0},"colour":"rgba(140, 246, 244, 1)","id":"165-615"},{"position":{"x":170.92363433250583,"y":912.6683659423576},"velocity":{"x":-0.038183040406538506,"y":-0.06772092624133631},"mass":{"x":1.6,"y":1.6},"radius":{"x":16,"y":16},"A":0.0804247719318987,"accelaration":{"x":0,"y":0},"colour":"rgba(218, 65, 120, 1)","id":"165-765"},{"position":{"x":181.90976634998117,"y":900.5084708625519},"velocity":{"x":-0.04511691517608579,"y":0.6354393689350806},"mass":{"x":0.5,"y":0.5},"radius":{"x":5,"y":5},"A":0.007853981633974483,"accelaration":{"x":0,"y":0},"colour":"rgba(188, 11, 101, 1)","id":"165-915"}]`;
            // const testJSON = `[{"position":{"x":15,"y":14.93466396719225},"velocity":{"x":0,"y":0.06543184177668367},"mass":{"x":1.5,"y":1.5},"radius":{"x":15,"y":15},"A":0.07068583470577035,"accelaration":{"x":0,"y":0},"colour":"rgba(198, 237, 91, 1)","id":"15-15"},{"position":{"x":98.68243087639738,"y":47.115583747337226},"velocity":{"x":-3.0318793904774357,"y":1.1070649634656604},"mass":{"x":3.6,"y":3.6},"radius":{"x":36,"y":36},"A":0.40715040790523715,"accelaration":{"x":0,"y":0},"colour":"rgba(159, 198, 154, 1)","id":"165-15"},{"position":{"x":null,"y":null},"velocity":{"x":null,"y":null},"mass":{"x":0,"y":0},"radius":{"x":0,"y":0},"A":0,"accelaration":{"x":0,"y":0},"colour":"rgba(112, 241, 92, 1)","id":"315-15"},{"position":{"x":486.9883131897638,"y":59.81774378495628},"velocity":{"x":0.9988318155309787,"y":2.9266399668940335},"mass":{"x":1.2000000000000002,"y":1.2000000000000002},"radius":{"x":12,"y":12},"A":0.04523893421169302,"accelaration":{"x":0,"y":0},"colour":"rgba(95, 80, 148, 1)","id":"465-15"},{"position":{"x":615,"y":45.83261326851713},"velocity":{"x":0,"y":1.9290547858499216},"mass":{"x":1.8,"y":1.8},"radius":{"x":18,"y":18},"A":0.10178760197630929,"accelaration":{"x":0,"y":0},"colour":"rgba(106, 11, 39, 1)","id":"615-15"},{"position":{"x":873.988037650119,"y":71.04413184704735},"velocity":{"x":4.899545806216434,"y":2.0983241494548066},"mass":{"x":4.2,"y":4.2},"radius":{"x":42,"y":42},"A":0.5541769440932396,"accelaration":{"x":0,"y":0},"colour":"rgba(248, 105, 43, 1)","id":"765-15"},{"position":{"x":934.3721282971172,"y":43.892359559192165},"velocity":{"x":-4.437146016584662,"y":0.3656566943567144},"mass":{"x":1.9000000000000001,"y":1.9000000000000001},"radius":{"x":19,"y":19},"A":0.11341149479459152,"accelaration":{"x":0,"y":0},"colour":"rgba(203, 90, 53, 1)","id":"915-15"},{"position":{"x":1021.2353951008998,"y":75.09131444981249},"velocity":{"x":0.409755493832037,"y":2.8769822896902597},"mass":{"x":4.1000000000000005,"y":4.1000000000000005},"radius":{"x":41,"y":41},"A":0.5281017250684442,"accelaration":{"x":0,"y":0},"colour":"rgba(134, 49, 45, 1)","id":"1065-15"},{"position":{"x":1215,"y":73.56051105040825},"velocity":{"x":0,"y":1.8500261576730859},"mass":{"x":4.9,"y":4.9},"radius":{"x":49,"y":49},"A":0.7542963961269092,"accelaration":{"x":0,"y":0},"colour":"rgba(61, 234, 207, 1)","id":"1215-15"},{"position":{"x":1430.6687199276128,"y":55.8345717774572},"velocity":{"x":2.9670047520029232,"y":1.4291754298865147},"mass":{"x":3.8000000000000003,"y":3.8000000000000003},"radius":{"x":38,"y":38},"A":0.4536459791783661,"accelaration":{"x":0,"y":0},"colour":"rgba(215, 127, 51, 1)","id":"1365-15"}]`

            let testBalls = JSON.parse(testJSON);
            // let testBalls = JSON.parse(`[{"position":{"x":19,"y":17},"velocity":{"x":1.9990077593762903,"y":1.0978519398440725},"mass":{"x":2.8000000000000003,"y":2.8000000000000003},"radius":{"x":28,"y":28},"A":0.24630086404143978,"accelaration":{"x":0,"y":0},"colour":"rgba(97, 128, 217, 1)","id":"15-15"},{"position":{"x":11,"y":171},"velocity":{"x":-2.0013111751099024,"y":3.09514985600272},"mass":{"x":3.7,"y":3.7},"radius":{"x":37,"y":37},"A":0.4300840342764427,"accelaration":{"x":0,"y":0},"colour":"rgba(21, 202, 216, 1)","id":"15-165"},{"position":{"x":19,"y":317},"velocity":{"x":1.9996101911835427,"y":1.0980025477958857},"mass":{"x":1.1,"y":1.1},"radius":{"x":11,"y":11},"A":0.03801327110843649,"accelaration":{"x":0,"y":0},"colour":"rgba(127, 26, 135, 1)","id":"15-315"},{"position":{"x":21,"y":475},"velocity":{"x":2.996172786165691,"y":5.087468850460252},"mass":{"x":4.800000000000001,"y":4.800000000000001},"radius":{"x":48,"y":48},"A":0.7238229473870883,"accelaration":{"x":0,"y":0},"colour":"rgba(219, 171, 162, 1)","id":"15-465"},{"position":{"x":7,"y":611},"velocity":{"x":-4.00127573794477,"y":-1.9022189344861924},"mass":{"x":0.9,"y":0.9},"radius":{"x":9,"y":9},"A":0.025446900494077322,"accelaration":{"x":0,"y":0},"colour":"rgba(243, 254, 64, 1)","id":"15-615"},{"position":{"x":7,"y":763},"velocity":{"x":-4.005953443742259,"y":-0.9022720902338912},"mass":{"x":4.2,"y":4.2},"radius":{"x":42,"y":42},"A":0.5541769440932396,"accelaration":{"x":0,"y":0},"colour":"rgba(229, 255, 214, 1)","id":"15-765"},{"position":{"x":15,"y":915},"velocity":{"x":0,"y":0.0981},"mass":{"x":2.4000000000000004,"y":2.4000000000000004},"radius":{"x":24,"y":24},"A":0.18095573684677208,"accelaration":{"x":0,"y":0},"colour":"rgba(42, 134, 238, 1)","id":"15-915"},{"position":{"x":167,"y":15},"velocity":{"x":0.999636769057392,"y":0.0981},"mass":{"x":4.1000000000000005,"y":4.1000000000000005},"radius":{"x":41,"y":41},"A":0.5281017250684442,"accelaration":{"x":0,"y":0},"colour":"rgba(117, 231, 184, 1)","id":"165-15"},{"position":{"x":167,"y":165},"velocity":{"x":0.9997430805527894,"y":0.0981},"mass":{"x":2.9000000000000004,"y":2.9000000000000004},"radius":{"x":29,"y":29},"A":0.2642079421669016,"accelaration":{"x":0,"y":0},"colour":"rgba(108, 65, 85, 1)","id":"165-165"},{"position":{"x":163,"y":319},"velocity":{"x":-1.0002657787384936,"y":2.097036885046025},"mass":{"x":3,"y":3},"radius":{"x":30,"y":30},"A":0.2827433388230814,"accelaration":{"x":0,"y":0},"colour":"rgba(244, 163, 165, 1)","id":"165-315"},{"position":{"x":163,"y":473},"velocity":{"x":-1.000150607951813,"y":4.09569027277099},"mass":{"x":1.7000000000000002,"y":1.7000000000000002},"radius":{"x":17,"y":17},"A":0.09079202768874503,"accelaration":{"x":0,"y":0},"colour":"rgba(109, 121, 47, 1)","id":"165-465"},{"position":{"x":173,"y":615},"velocity":{"x":3.99872426205523,"y":0.0981},"mass":{"x":0.9,"y":0.9},"radius":{"x":9,"y":9},"A":0.025446900494077322,"accelaration":{"x":0,"y":0},"colour":"rgba(177, 58, 172, 1)","id":"165-615"},{"position":{"x":163,"y":757},"velocity":{"x":null,"y":null},"mass":{"x":0,"y":0},"radius":{"x":0,"y":0},"A":0,"accelaration":{"x":0,"y":0},"colour":"rgba(83, 45, 104, 1)","id":"165-765"},{"position":{"x":169,"y":911},"velocity":{"x":1.9984053275690379,"y":-1.9034946724309623},"mass":{"x":4.5,"y":4.5},"radius":{"x":45,"y":45},"A":0.6361725123519332,"accelaration":{"x":0,"y":0},"colour":"rgba(71, 228, 31, 1)","id":"165-915"}]`)
            let testBallPairs = ballPairs(testBalls);
            collisionLoop(cirleOverlaps, objectCollisions, testBalls, testBallPairs);

            testBalls = JSON.parse(testJSON);
            testBallPairs = ballPairs(testBalls);
            collisionLoop2(cirleOverlaps, objectCollisions, testBalls, testBallPairs);

            testBalls = JSON.parse(testJSON);
            testBallPairs = ballPairs(testBalls);
            collisionLoop3(cirleOverlaps, objectCollisions, testBalls, testBallPairs);

            testBalls = JSON.parse(testJSON);
            testBallPairs = ballPairs(testBalls);
            collisionLoop4(cirleOverlaps, objectCollisions, testBalls, testBallPairs);
        </script>
    </body>
</html>